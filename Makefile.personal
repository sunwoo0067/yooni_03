# Yooni Dropshipping System - Personal User Edition
# ê°œì¸ ì‚¬ìš©ììš© Makefile

.PHONY: help setup run stop logs clean test

# ê¸°ë³¸ íƒ€ê²Ÿ
help:
	@echo "Yooni ë“œë¡­ì‰¬í•‘ ì‹œìŠ¤í…œ - ê°œì¸ ì‚¬ìš©ììš© Makefile"
	@echo ""
	@echo "ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´:"
	@echo "  setup     - ê°œì¸ ì‚¬ìš©ììš© í™˜ê²½ ì„¤ì •"
	@echo "  run       - ê°œì¸ ì‚¬ìš©ììš© ì„œë²„ ì‹¤í–‰"
	@echo "  stop      - ì„œë²„ ì¤‘ì§€"
	@echo "  logs      - ë¡œê·¸ í™•ì¸"
	@echo "  clean     - ì„ì‹œ íŒŒì¼ ì •ë¦¬"
	@echo "  test      - í…ŒìŠ¤íŠ¸ ì‹¤í–‰"
	@echo "  frontend  - í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„ ì‹¤í–‰"
	@echo "  docker-up - Dockerë¡œ ê°œì¸ ì‚¬ìš©ììš© ì‹œìŠ¤í…œ ì‹¤í–‰"
	@echo "  docker-down - Docker ì‹œìŠ¤í…œ ì¤‘ì§€"

# ê°œì¸ ì‚¬ìš©ììš© í™˜ê²½ ì„¤ì •
setup:
	@echo "ğŸ”§ ê°œì¸ ì‚¬ìš©ììš© í™˜ê²½ ì„¤ì • ì¤‘..."
	pip install -r requirements-personal.txt
	cd frontend && npm install
	@echo "âœ… í™˜ê²½ ì„¤ì • ì™„ë£Œ"

# ê°œì¸ ì‚¬ìš©ììš© ì„œë²„ ì‹¤í–‰
run:
	@echo "ğŸš€ ê°œì¸ ì‚¬ìš©ììš© ì„œë²„ ì‹¤í–‰ ì¤‘..."
	@echo "   ì ‘ì† ì£¼ì†Œ: http://localhost:8000"
	@echo "   API ë¬¸ì„œ: http://localhost:8000/docs"
	export YOONI_ENV_MODE=personal && python backend/main_personal.py

# ì„œë²„ ì¤‘ì§€
stop:
	@echo "ğŸ›‘ ì„œë²„ ì¤‘ì§€ ì¤‘..."
	pkill -f "python backend/main_personal.py" || true
	@echo "âœ… ì„œë²„ ì¤‘ì§€ ì™„ë£Œ"

# ë¡œê·¸ í™•ì¸
logs:
	@echo "ğŸ“‹ ë¡œê·¸ í™•ì¸ ì¤‘..."
	tail -f backend/logs/personal_app.log

# ì„ì‹œ íŒŒì¼ ì •ë¦¬
clean:
	@echo "ğŸ§¹ ì„ì‹œ íŒŒì¼ ì •ë¦¬ ì¤‘..."
	rm -rf backend/logs/*.log
	rm -rf frontend/logs/*.log
	rm -rf backend/__pycache__
	rm -rf frontend/__pycache__
	@echo "âœ… ì„ì‹œ íŒŒì¼ ì •ë¦¬ ì™„ë£Œ"

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
test:
	@echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘..."
	python -m pytest backend/tests/personal/ -v

# í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„ ì‹¤í–‰
frontend:
	@echo "ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„ ì‹¤í–‰ ì¤‘..."
	@echo "   ì ‘ì† ì£¼ì†Œ: http://localhost:3000"
	cd frontend && npm run dev

# Dockerë¡œ ê°œì¸ ì‚¬ìš©ììš© ì‹œìŠ¤í…œ ì‹¤í–‰
docker-up:
	@echo "ğŸ³ Dockerë¡œ ê°œì¸ ì‚¬ìš©ììš© ì‹œìŠ¤í…œ ì‹¤í–‰ ì¤‘..."
	docker-compose -f docker-compose.personal.yml up -d
	@echo "âœ… Docker ì‹œìŠ¤í…œ ì‹¤í–‰ ì™„ë£Œ"
	@echo "   ë°±ì—”ë“œ: http://localhost:8000"
	@echo "   í”„ë¡ íŠ¸ì—”ë“œ: http://localhost:3000"

# Docker ì‹œìŠ¤í…œ ì¤‘ì§€
docker-down:
	@echo "ğŸ›‘ Docker ì‹œìŠ¤í…œ ì¤‘ì§€ ì¤‘..."
	docker-compose -f docker-compose.personal.yml down
	@echo "âœ… Docker ì‹œìŠ¤í…œ ì¤‘ì§€ ì™„ë£Œ"